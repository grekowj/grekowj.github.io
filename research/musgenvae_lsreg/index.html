<!DOCTYPE html>
<html>
    <head>
        <meta HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
        <title>Emotional Regularization of the Latent Space of a VAE</title>

        <meta NAME="KEYWORDS" CONTENT="Jacek Grekow, Emotional Regularization of the Latent Space of a VAE ">
        <meta name="description" content="Emotional Regularization of the Latent Space of a VAE">
        <meta name="robots" content="index, follow">
        <link href="../../styl1.css" rel="stylesheet" type="text/css"/>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script>
            function openNav() {
                document.getElementById("mySidebar").style.width = "250px";
                document.getElementById("main").style.marginLeft = "250px";
            }

            function closeNav() {
                document.getElementById("mySidebar").style.width = "0";
                document.getElementById("main").style.marginLeft = "0";
            }
        </script>

        <script src="https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.4.0"></script>



    </head>
    <body>
        <div class="main">
            <div id="mySidebar" class="sidebar">
                <a href="javascript:void(0)" class="closebtn" id="closebtn" onclick="closeNav()">×</a>
                <a href="http://pb.edu.pl/" target="blanc">  <img class="logo" SRC="../../logo/LogoPB.jpg" NAME="logo PB" > </a>
                <a href="http://wi.pb.edu.pl/" target="blanc">  <img class="logo" SRC="../../logo/wi.png" NAME="logo WI PB" > </a>


                <a HREF="../../index.html">Home</a>
                <a HREF="../../jgTeaching.html">Teaching</a>
                <a HREF="../../jgResearch.html">Research</a>
                <a HREF="../../jgCV.html">CV</a>
                <a HREF="../../jgLinks.html">Related Links</a>
                <a HREF="../../jgMusic.html">Music</a>
                <a HREF="../../jgPraceDypl.html">Students</a>




            </div>
            <table class="cala-szer">
                <tr>
                    <!--                    <td class="col-lewa">
                    
                                            <p class="msonormal-center">
                                                <a href="http://pb.edu.pl/" target="blanc">  <img class="logo" SRC="../logo/LogoPB.jpg" alt="Logo PB" > </a>
                                            </p>
                                            <p class="msonormal-center">
                                                <a href="http://wi.pb.edu.pl/" target="blanc">  <img class="logo" SRC="../logo/wi.png" alt="Logo WI PB" > </a>
                                            </p>
                    
                                        </td>             -->

                    <td class="col-srodek">
                        <table class="cala-szer">
                            <tr>

                                <td class="col-srodek-nagl">
                                    <p class="msonormal-center">
                                        Faculty of Computer Science 
                                    </p>
                                    <p class="msonormal-center">
                                        Bialystok University od Technology
                                    </p>
                                    <p class="msonormal-center">
                                        dr hab. inż. JACEK GREKOW</p>
                                </td>

                            </tr>
                        </table>

                        <table class="cala-szer">

                            <tr VALIGN=TOP>
                                <!--                                <td class="col-lewa">
                                                                    <p class="menu"><a HREF="../../index.html">Home</a></p>
                                                                    <p class="menu"><a HREF="../../jgTeaching.html">Teaching</a></p>
                                                                    <p class="menu"><a HREF="../../jgResearch.html">Research</a></p>
                                                                    <p class="menu"><a HREF="../../jgCV.html">CV</a></p>
                                                                    <p class="menu"><a HREF="../../jgLinks.html">Related Links</a></p>
                                                                    <p class="menu"><a HREF="../../jgMusic.html">Music</a></p>
                                                                    <p class="menu"><a HREF="../../jgPraceDypl.html">Students</a></p>
                                
                                                                </td>-->
                                <td class="col-srodek">
                                    <div id="main">
                                        <button class="openbtn" onclick="openNav()">☰</button>  
                                    </div>
                                    <p class="menu"> </p>

                                    <h1>Grekow J. - Emotional Regularization of the Latent Space of a Variational Autoencoder for Generating Musical Sequences</h1>
                                    <p>This article presents a new regularization of the latent space of a variational autoencoder that will facilitate the visual selection of specific emotions of generated monophonic musical sequences. 
                                        This regularization allocates the regions of a two-dimensional space according to the quadrants of an emotion model. 
                                        The cosine similarity between the vectors in the latent space and the feature vectors of the training examples was used to calculate the loss, which extends the standard loss of the variational autoencoder. 
                                        By mapping the emotion model to a latent space, this space will become more interpretable when generating new examples of music. A two-dimensional Russell model was used as the emotion model, with its four quadrants corresponding to basic emotions, such as happy, angry, sad, and relaxed. 
                                        Variational autoencoder models employing recurrent neural networks were constructed and trained on a dataset of monophonic music sequences labeled with emotions. The obtained latent space and generated music files with different emotions were evaluated. </p>
                                    <hr>

                                    <ul>
                                        <li><a HREF="https://github.com/grekowj/musgenvaecnn_4v" target="_blank">
                                                Training dataset, code, generated examples  _ do poprawy</a></li>
                                        <!--<li><a HREF="./generated_exaples">Generated exaples </a></li>-->                              

                                    </ul>

                                    <table class="cala-szer">
                                        <tr>
                                            <td>
                                                <img class="figure" SRC="./latent_space_0700_noEmoReg_v05.png" NAME="ls1" > 
                                                <h2>Figure 1. Latent space of the baseline model CVAE-Base - without regularization </h2>
                                            </td>
                                            <td>
                                                <img class="figure" SRC="./latent_space_0700_v05.png" NAME="ls1" > 
                                                <h2>Figure 2. Latent space of the CVAE-EmoReg model - after regularization</h2>                                                
                                            </td>
                                        </tr>
                                    </table>

                                    <hr/>

                                    <img class="figure" SRC="./generated-emo-examples.png" NAME="ls1" > 
                                    <h2> Figure 3. Examples of generated musical sequences with given emotions (a) e1, (b) e2, (c) e3, and (d) e4
                                    </h2> 

                                    <hr/>

                                    <h2>Table 1. Generated MIDI music examples labeled with four emotions using - CVAE-EmoReg model</h2>
                                    
                                    <table class="cala-szer">
                                        <tr>
                                            <td>
                                                <b>Example</b>
                                            </td>
                                            <td>
                                                <b>Emotion</b>
                                            </td>
                                            <td>
                                                <b>Quarter in Russell's model /  Arousal-Valence</b>
                                            </td>
                                            <td>
                                                <b>MIDI</b>
                                            </td>
                                        </tr>

                                        <tr>
                                            <td>
                                                Example_1   
                                            </td>
                                            <td>
                                                e1   
                                            </td>
                                            <td>
                                                Q1 / high-high 
                                            </td>
                                            <td>
                                                <p>
                                        <midi-player  src="./examples/e1/new_generated_0.mid"
                                                      sound-font visualizer="#myVisualizer_1">
                                        </midi-player>
                                        <midi-visualizer type="piano-roll" id="myVisualizer_1"></midi-visualizer>
                                        </p>
                                </td>
                            </tr>
                            
                              <tr>
                                            <td>
                                                Example_2   
                                            </td>
                                            <td>
                                                e1   
                                            </td>
                                            <td>
                                                Q1 / high-high 
                                            </td>
                                            <td>
                                                <p>
                                        <midi-player  src="./examples/e1/new_generated_2.mid"
                                                      sound-font visualizer="#myVisualizer_2">
                                        </midi-player>
                                        <midi-visualizer type="piano-roll" id="myVisualizer_2"></midi-visualizer>
                                        </p>
                                </td>
                            </tr>
                            
                              <tr>
                                            <td>
                                                Example_3 
                                            </td>
                                            <td>
                                                e1   
                                            </td>
                                            <td>
                                                Q1 / high-high 
                                            </td>
                                            <td>
                                                <p>
                                        <midi-player  src="./examples/e1/new_generated_4.mid"
                                                      sound-font visualizer="#myVisualizer_3">
                                        </midi-player>
                                        <midi-visualizer type="piano-roll" id="myVisualizer_3"></midi-visualizer>
                                        </p>
                                </td>
                            </tr>
<!--___________________________________________________________________________-->
                            <tr>

                                <td>
                                    Example_4   
                                </td>
                                <td>
                                    e2   
                                </td>
                                <td>
                                    Q2 / high-low 
                                </td>
                                <td>

                            <midi-player  src="./examples/e2/new_generated_11.mid" sound-font visualizer="#myVisualizer_4">
                            </midi-player>
                            <midi-visualizer type="piano-roll" id="myVisualizer_4"></midi-visualizer>

                    </td>
                </tr>
                
                 <tr>

                                <td>
                                    Example_5   
                                </td>
                                <td>
                                    e2   
                                </td>
                                <td>
                                    Q2 / high-low 
                                </td>
                                <td>

                            <midi-player  src="./examples/e2/new_generated_0.mid" sound-font visualizer="#myVisualizer_5">
                            </midi-player>
                            <midi-visualizer type="piano-roll" id="myVisualizer_5"></midi-visualizer>

                    </td>
                </tr>
                
                 <tr>

                                <td>
                                    Example_6   
                                </td>
                                <td>
                                    e2   
                                </td>
                                <td>
                                    Q2 / high-low 
                                </td>
                                <td>

                            <midi-player  src="./examples/e2/new_generated_13.mid" sound-font visualizer="#myVisualizer_6">
                            </midi-player>
                            <midi-visualizer type="piano-roll" id="myVisualizer_6"></midi-visualizer>

                    </td>
                </tr>

                <tr>
                    <td>
                        Example_7   
                    </td>
                    <td>
                        e3   
                    </td>
                    <td>
                        Q3 / low-low 
                    </td>
                    <td>
                <midi-player  src="./examples/e3/new_generated_2.mid"
                              sound-font visualizer="#myVisualizer_7">
                </midi-player>
                <midi-visualizer type="piano-roll" id="myVisualizer_7"></midi-visualizer>
                </td>
                </tr>
                
                <tr>
                    <td>
                        Example_8   
                    </td>
                    <td>
                        e3   
                    </td>
                    <td>
                        Q3 / low-low 
                    </td>
                    <td>
                <midi-player  src="./examples/e3/new_generated_4.mid"
                              sound-font visualizer="#myVisualizer_8">
                </midi-player>
                <midi-visualizer type="piano-roll" id="myVisualizer_8"></midi-visualizer>
                </td>
                </tr>
                
                <tr>
                    <td>
                        Example_9   
                    </td>
                    <td>
                        e3   
                    </td>
                    <td>
                        Q3 / low-low 
                    </td>
                    <td>
                <midi-player  src="./examples/e3/new_generated_6.mid"
                              sound-font visualizer="#myVisualizer_9">
                </midi-player>
                <midi-visualizer type="piano-roll" id="myVisualizer_9"></midi-visualizer>
                </td>
                </tr>

                <tr>
                    <td>
                        Example_10   
                    </td>
                    <td>
                        e4   
                    </td>
                    <td>
                        Q4 / low-high 
                    </td>
                    <td>
                <midi-player  src="./examples/e4/new_generated_4.mid"
                              sound-font visualizer="#myVisualizer_10">
                </midi-player>
                <midi-visualizer type="piano-roll" id="myVisualizer_10"></midi-visualizer>
                </td>
                </tr>
                
                <tr>
                    <td>
                        Example_11  
                    </td>
                    <td>
                        e4   
                    </td>
                    <td>
                        Q4 / low-high 
                    </td>
                    <td>
                <midi-player  src="./examples/e4/new_generated_7.mid"
                              sound-font visualizer="#myVisualizer_11">
                </midi-player>
                <midi-visualizer type="piano-roll" id="myVisualizer_11"></midi-visualizer>
                </td>
                </tr>
                
                <tr>
                    <td>
                        Example_12  
                    </td>
                    <td>
                        e4   
                    </td>
                    <td>
                        Q4 / low-high 
                    </td>
                    <td>
                <midi-player  src="./examples/e4/new_generated_10.mid"
                              sound-font visualizer="#myVisualizer_12">
                </midi-player>
                <midi-visualizer type="piano-roll" id="myVisualizer_12"></midi-visualizer>
                </td>
                </tr>


            </table>

            <!--<img class="figure" SRC="./Pictures/P1-AV-Rub-Sok.png" alt="Aplication" width="100">--> 


        </td>

    </tr>

</table>
<hr>

<p class="stopka">Copyright &copy; 2001-
    <script language="javascript" type="text/javascript"> var today = new Date();
        var year = today.getFullYear();
        document.write(year);</script>
    Home Page of Jacek Grekow</p>
</td>

<td class="col-prawa">

</td>

</tr>




</table>

<p><br><br>
</p>


</div>
</body>
</html>


